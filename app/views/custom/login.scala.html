@(loginForm: play.api.data.Form[(String,String)], errorMsg: Option[String] = None)(implicit request: play.api.mvc.RequestHeader)

@import helper._
@import securesocial.core.Registry
@import securesocial.core.AuthenticationMethod._
@import securesocial.core.providers.UsernamePasswordProvider.UsernamePassword

@main(Messages("securesocial.login.title")){
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="col-xs-12 col-md-10 col-md-offset-1 col-xs-offset-0">

                <div class="page-header">
                    <h1>@Messages("securesocial.login.title")</h1>
                </div>

                @errorMsg.map { msg =>
                    <div class="alert alert-error animated fadeIn">
                        @Messages(msg)
                    </div>
                }

                @request.flash.get("success").map { msg =>
                    <div class="alert alert-info animated fadeIn">
                        @msg
                    </div>
                }

                @request.flash.get("error").map { msg =>
                    <div class="alert alert-error animated fadeIn">
                        @msg
                    </div>
                }


                @defining( Registry.providers.all.values.filter( _.id != UsernamePassword) ) { externalProviders =>

                        @Registry.providers.get(UsernamePassword).map { up =>
                            <div class="col-xs-12 col-md-4 col-md-offset-1 login-form">
                                @if( externalProviders.size > 0 ) {
                                    <h3>@Messages("securesocial.login.useEmailAndPassword")</h3>
                                } else {
                                    <h3>@Messages("securesocial.login.useEmailAndPasswordOnly")</h3>
                                }

                               @custom.provider("userpass", Some(loginForm))(request)
                            </div>
                        }

                        @if( externalProviders.size > 0 ) {
                            <div class="col-xs-12 col-md-4 col-md-offset-1 login-form">
                                <h3>@Messages("securesocial.login.instructions")</h3>
                                <p class="provider-icons margin-top">
                                @for(p <- externalProviders) {
                                    @custom.provider(p.id)(request)
                                }
                                </p>
                            </div>
                        }
                    }

            </div>
        </div>
    </div>
}
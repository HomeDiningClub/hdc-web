@(userProfile: models.UserProfile,
        tab1: String,
        tab2: String,
        tab3: String,
        tab4: String,
        tab5: String,
        recipeBoxes: Option[List[models.viewmodels.RecipeBox]] = None,
        myReviewBoxes: Option[List[models.viewmodels.ReviewBox]] = None,
        myRecipeReviewBoxes: Option[List[models.viewmodels.ReviewBox]] = None,
        reviewBoxesAboutMyFood: Option[List[models.viewmodels.ReviewBox]] = None,
        reviewBoxesAboutMe: Option[List[models.viewmodels.ReviewBox]] = None,
        userMessages: Option[List[models.message.Message]] = None,
        tagList: Option[List[models.profile.TagWord]] = None,
        metaData: Option[viewmodels.MetaData] = None,
        isThisMyProfile: Boolean = false)(implicit request: RequestHeader, flash: Flash)

    @pageScripts= {
        <script>
            /*
            var showChar = 50;
            var ellipsestext = "...";
            var moretext = "mer";
            var lesstext = "mindre";
            */

            /* Code to open a mail directly, not working atm */
            $(document).ready(function(){
                var url = document.location.toString();
                if (url.match('#')){
                    $('.nav-tabs a[href=#'+url.split('#')[1]+']').tab('show') ;
                    var msgId = url.split('#')[2].split("Some(")[1].substring(0, url.split('#')[2 ].split("Some(")[1 ].length -1);

                    $('#mail_' + msgId).click();
                }

            /* Mark mail as read, also read more functionality */
            $(".mail-inbox-row").click(function(){
                var btnArray = this.id.split("mail_");
                var mailRowId = "#mail_" + btnArray[1];
                if($(mailRowId + " .unread").is(":visible")){
                    $.get( "/profile/mark?msgId=" + btnArray[1] + "&tid=" + new Date().toString(), function (data, status){
                        $(mailRowId + " .read").show();
                        $(mailRowId + " .unread").hide();
                    });
                }
            });

            /* Couldn't find a ref to this code
            $('.more').each(function() {
                var content = $(this).html();

                if(content.length > showChar) {

                    var c = content.substr(0, showChar);
                    var h = content.substr(showChar-1, content.length - showChar);

                    var html = c + '<span class="moreellipses">' + ellipsestext+ '&nbsp;</span><span class="morecontent"><span>' + h + '</span>&nbsp;&nbsp;<a href="" class="morelink">' + moretext + '</a></span>';

                    $(this).html(html);
                }
            });

            $(".morelink").click(function(){
                if($(this).hasClass("less")) {
                    $(this).removeClass("less");
                    $(this).html(moretext);
                } else {
                    $(this).addClass("less");
                    $(this).html(lesstext);
                }
                    $(this).parent().prev().toggle();
                    $(this).prev().toggle();
                    return false;
            });
            */

        $("#rf").click(function(){
        $.get("/profile/favorite/remove?userCredentialObjectId=@userProfile.getOwner().objectId&tid=" + new Date().toString(),function(data,status){
            $( "#af" ).show();
            $( "#rf" ).hide();
         alert('Favorit borttagen!');
        });
        });


        $("#af").click(function(){
        $.get("/profile/favorite/add?userCredentialObjectId=@userProfile.getOwner().objectId&tid=" + new Date().toString(),function(data,status){
        $( "#af" ).hide();
        $( "#rf" ).show();
         alert('Favorit tillagd!')
        });
        });



        $.get("/profile/favorite/isFav?userCredentialObjectId=@userProfile.getOwner().objectId&tid=" + new Date().toString(),function(data,status){
        if(data =="YES") {
            $( "#af" ).hide();
            $( "#rf" ).show();
        } else if(data == "NO") {
            $( "#af" ).show();
            $( "#rf" ).hide();

        } else {
            $( "#af,#rf,#afrf-wrapper" ).hide();
        }

        });

        });
        </script>
    }


@main(title = Messages("profile.title", userProfile.profileLinkName), footerScripts = pageScripts, metaData = metaData) {
    <div class="container host-container">
        <div class="row">
            <div class="col-xs-12 col-md-9">
                @defining(if(userProfile.getAvatarImage != null){controllers.routes.ImageController.userThumb(userProfile.getAvatarImage.getStoreId).url}else{""}){ avatarUrl =>
                    @views.html.profile.profileHeader(userProfile.profileLinkName, userProfile.getOwner.firstName, avatarUrl, false)
                }
                <div class="row">
                    <div class="col-xs-12 col-md-6 big-margin-top">
                        <section>
                            <article>
                                <h1 class="page-header hidden">@userProfile.profileLinkName</h1>
                                @shared.grade(inputId = "host-grade", initialValue = userProfile.getOwner.getAverageRating, size = "xs", cssClass = "hdc-grade-pull-left pull-left", disabled = true, showCaption = false, showNrOfRatings = true, nrOfRatings = userProfile.getOwner.getNrOfRatings)
                                @if(!isThisMyProfile) {
                                    @RatingController.renderUserRateForm(userProfile.getOwner, routes.UserProfileController.viewProfileByName(userProfile.profileLinkName).url)(request)
                                }

                                @* Member id hidden for now:
                                <div class="memberid clearfix"><p><strong>@Messages("profile.memberid.text")</strong>&nbsp;@userProfile.getOwner.objectId</p></div>*@

                                @*  Share / Like / Fav *@
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div id="afrf-wrapper" class="btn-group-likes">
                                            <a id="af" hidden="true" class="btn btn-default btn-favorite" title="@Messages("favorite.add.title")"><span class="glyphicon glyphicon-paperclip"></span>&nbsp;&nbsp;@Messages("favorite.add.text")</a>
                                            <a id="rf" hidden="true" class="btn btn-default btn-favorite btn-favorite-active" title="@Messages("favorite.remove.title")"><span class="glyphicon glyphicon-paperclip"></span>&nbsp;&nbsp;@Messages("favorite.remove.text")</a>
                                        </div>
                                        @LikeController.renderUserLikeForm(userProfile.getOwner)(request)
                                        @shared.fbShare(url = request.uri)
                                    </div>
                                </div>
                                <hr class="hr-orange hr-like">

                                <h2>@userProfile.aboutMeHeadline</h2>




                                <p id="result"></p>

                                <div class="breadtext">
                                    @Html(userProfile.aboutMe)
                                </div>
                                @shared.flashmsg(flash)
                                @* Send request *@
                                @if(!isThisMyProfile && userProfile.isUserHost) {

                                    @MessagesController.renderHostForm(userProfile.getOwner)(request)
                                }
                            </article>
                        </section>
                    </div>
                    <div class="col-xs-12 col-md-6 big-margin-top">
                        @userProfile.getMainImage match {
                            case image: models.files.ContentFile => {
                                <div id="host-main-carousel" data-ride="carousel" data-interval="4000" class="carousel slide host-image-gallery">
                                        <!-- Slider carousel items -->
                                    <div class="carousel-inner">
                                        <div class="active crop-height item" data-slide-number="0">@shared.img(routes.ImageController.profileNormal(image.getStoreId).url, cssClass = "img-responsive")</div>
                                    </div>
                                    @*<!-- Carousel nav controls -->*@
                                    @*<a class="carousel-control left hidden-md hidden-lg" href="#host-main-carousel" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a>*@
                                    @*<a class="carousel-control right hidden-md hidden-lg" href="#host-main-carousel" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>*@
                                </div>
                                @*<!-- Thumbnails, don't show responsive -->*@
                                @*<ul class="host-main-carousel-thumbs list-inline hidden-xs hidden-sm">*@
                                @*<li class="col-md-3"><a id="carousel-selector-0" class="selected">@shared.img("images/host/image1.jpg", cssClass = "img-responsive")</a></li>*@
                                @*<li class="col-md-3"><a id="carousel-selector-1">@shared.img("images/host/image2.jpg", cssClass = "img-responsive")</a></li>*@
                                @*<li class="col-md-3"><a id="carousel-selector-2">@shared.img("images/host/image3.jpg", cssClass = "img-responsive")</a></li>*@
                                @*<li class="col-md-3"><a id="carousel-selector-3">@shared.img("images/host/image4.jpg", cssClass = "img-responsive")</a></li>*@
                                @*<li class="col-md-3"><a id="carousel-selector-4">@shared.img("images/host/image5.jpg", cssClass = "img-responsive")</a></li>*@
                                @*</ul>*@
                            }
                            case _ => {
                                <div class="host-image-gallery">
                                    @shared.img("images/profile/profile-default-main-image.jpg", cssClass = "img-responsive")
                                </div>
                            }
                        }

                        <div class="panel panel-default panel-dropshadow big-margin-top">
                            <div class="panel-body">
                                @shared.tagList(tagList, userProfile.getOwner.firstName())
                                <br><strong>@Messages("profile.firstname.label")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.fistName)</span>
                                <br><strong>@Messages("profile.city.label")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.city)</span>
                                <br>@if(userProfile.getLocations.iterator().hasNext()){
                                <strong>@Messages("profile.county.text")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.getLocations.iterator().next().county.name)</span>
                                }
                                <br><strong>@Messages("profile.options.childFfriendly.label")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.childFfriendly)</span>
                                <br><strong>@Messages("profile.options.handicapFriendly.label")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.handicapFriendly)</span>
                                <br><strong>@Messages("profile.options.havePets.label")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.havePets)</span>
                                <br><strong>@Messages("profile.options.smoke.label")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.smoke)</span>
                                <br><strong>@Messages("profile.options.allkoholServing.label")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.allkoholServing)</span>
                                <br><strong>@Messages("profile.payment.label")</strong> <span class="sentence-case">@utils.Helpers.titleCase(userProfile.payBankCard) @utils.Helpers.titleCase(userProfile.payCache) @utils.Helpers.titleCase(userProfile.payIZettle) @utils.Helpers.titleCase(userProfile.paySwish)</span>
                                <br><strong>@Messages("profile.nr-of-guests.label")</strong> <span class="sentence-case">
                                    @{userProfile.minNoOfGuest match {
                                        case "" | null => { 1 }
                                        case minGuests => { minGuests }
                                    }}
                                @Messages("profile.nr-of-guests.to")
                                    @{userProfile.maxNoOfGuest match {
                                        case "" | null => { 4 }
                                        case maxGuests => { maxGuests }
                                    }}
                                    personer
                                </span>


                            </div>
                        </div>

                        @if((myReviewBoxes.nonEmpty || myRecipeReviewBoxes.nonEmpty) && isThisMyProfile) {


                                <div class="panel panel-default panel-dropshadow big-margin-top">
                                    <div class="panel-body">
                                        Antal besökare:
                                        <br>
                                        <table style="width:100%">
                                            <tr>
                                                <td>Inloggade:</td>
                                                <td align="right">
                                                @{userProfile.getmemberVisited() match {
                                                    case  null => { 0 }
                                                    case _ => { userProfile.getmemberVisited().getSize }
                                                }}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Icke inloggade: </td>
                                                <td align="right">
                                                @{userProfile.getUnKnownVisited() match {
                                                    case  null => { 0 }
                                                    case _ => { userProfile.getUnKnownVisited().getSize }
                                                }}
                                                </td>
                                            </tr>
                                        </table>

                                    </div>
                                </div>
                        }
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12 col-md-12 big-margin-top">
                        <nav>
                            <ul class="nav nav-tabs nav-tabs-profile">
                                <li class="active"><a data-toggle="tab" href="#@tab1" title="@Messages("profile.tabs.food.title")"><span class="glyphicon glyphicon-cutlery"></span>&nbsp;@Messages("profile.tabs.food.name")</a></li>
                                @if(userProfile.isUserHost) {
                                    <li><a data-toggle="tab" href="#@tab2" title="@Messages("profile.tabs.blog.title")">@Messages("profile.tabs.blog.name")</a></li>
                                }
                                <li><a data-toggle="tab" href="#@tab3" title="@Messages("profile.tabs.ratings.title")"><span class="glyphicon glyphicon-star"></span>&nbsp;@Messages("profile.tabs.ratings.name")</a></li>
                                @if(isThisMyProfile) {
                                    <li><a data-toggle="tab" href="#@tab4" title="@Messages("profile.tabs.inbox.title")"><span class="glyphicon glyphicon-envelope"></span>&nbsp;@Messages("profile.tabs.inbox.name")</a></li>
                                    <li><a data-toggle="tab" href="#@tab5" title="@Messages("profile.tabs.favourites.title")"><span class="glyphicon glyphicon-paperclip"></span>&nbsp;@Messages("profile.tabs.favourites.name")</a></li>
                                }
                            </ul>
                        </nav>

                        <div class="tab-content">
                            <div class="tab-pane tab-hdc fade in active" id="@tab1">
                                <div class="row">
                                @if(isThisMyProfile) {
                                    <div class="col-xs-12">
                                        <div class="btn-group btn-edit-group">
                                            <a href="@controllers.routes.RecipePageController.add" class="btn btn-primary"><span class="glyphicon glyphicon-plus"></span> @Messages("profile.button.recipe.add")</a>
                                        </div>
                                    </div>
                                }
                                </div>
                                @if(recipeBoxes.nonEmpty){
                                    @recipe.recipeBox(userProfile.profileLinkName)
                                }
                            </div>
                            @if(userProfile.isUserHost) {
                                <div class="tab-pane tab-hdc fade" id="@tab2">
                                    <div class="row">
                                    @if(isThisMyProfile) {
                                        <div class="col-xs-12">
                                            <div class="btn-group btn-edit-group">
                                                <a href="@controllers.routes.BloggPostsPageController.add" class="btn btn-primary"><span class="glyphicon glyphicon-plus"></span> @Messages("profile.button.blogg.add")</a>
                                            </div>
                                        </div>
                                    }
                                    </div>
                                <!-- @Messages("profile.blog.tab.body") -->
                                    @if(userProfile.getRole.size() > 1){
                                        @blogg.bloggBox(userProfile.profileLinkName)
                                    } else {
                                        @Messages("profile.blog.tab.body")
                                    }

                                </div>
                            }
                            <div class="tab-pane tab-hdc fade" id="@tab3">
                                @if(reviewBoxesAboutMe.nonEmpty){
                                    <!-- Reviews about user -->
                                    <div class="row">
                                        <div class="col-xs-12">
                                            <h3>
                                            @if(isThisMyProfile) {
                                                @Messages("profile.reviews.reviews.aboutme.header")
                                            }else {
                                                @Messages("profile.reviews.reviews.aboutme.username.header", userProfile.profileLinkName)
                                            }
                                            </h3>
                                        </div>
                                        @shared.reviewBox(reviewBoxesAboutMe.get)
                                    </div>
                                }
                                @if(reviewBoxesAboutMyFood.nonEmpty){
                                    <!-- Reviews about his recipes -->
                                    <div class="row">
                                        <div class="col-xs-12 big-margin-top">
                                            <h3>
                                                @if(isThisMyProfile) {
                                                    @Messages("profile.reviews.reviews.aboutmyfood.header")
                                                }else {
                                                    @Messages("profile.reviews.reviews.aboutmyfood.username.header", userProfile.profileLinkName)
                                                }
                                            </h3>
                                        </div>
                                        @shared.reviewBox(reviewBoxesAboutMyFood.get)
                                    </div>
                                }

                                @if((myReviewBoxes.nonEmpty || myRecipeReviewBoxes.nonEmpty) && isThisMyProfile) {
                                    <hr class="hr-orange big-margin-top">
                                }
                                @if(myReviewBoxes.nonEmpty && isThisMyProfile){
                                    <!-- Reviews by me -->
                                    <div class="row big-margin-top">
                                        <div class="col-xs-12"><h3>@Messages("profile.reviews.myreviews.user.header")</h3></div>
                                        @shared.reviewBox(myReviewBoxes.get)
                                    </div>
                                }
                                @if(myRecipeReviewBoxes.nonEmpty && isThisMyProfile){
                                    <!-- Food-Reviews by me -->
                                    <div class="row big-margin-top">
                                        <div class="col-xs-12"><h3>@Messages("profile.reviews.myreviews.food.header")</h3></div>
                                        @shared.reviewBox(myRecipeReviewBoxes.get)
                                    </div>
                                }

                            </div>
                            <div class="tab-pane tab-hdc fade" id="@tab4">
                                @if(isThisMyProfile && userMessages.nonEmpty) {

                                    <table class="table inbox-table">
                                        <thead>
                                            <tr>
                                                <th>@Messages("mails.inbox.header.read")</th>
                                                <th>@Messages("mails.inbox.header.from")</th>
                                                <th>@Messages("mails.inbox.header.message")</th>
                                                <th>@Messages("mails.inbox.header.date")</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @for(msg <- userMessages.get) {
                                                @MessagesController.renderMessage(msg)(request)
                                            }
                                        </tbody>
                                    </table>

                                }
                            </div>
                            @if(isThisMyProfile) {
                            <div class="tab-pane tab-hdc fade" id="@tab5">
                                @FavoritesController.renderFavorites(userProfile)
                            </div>
                            }
                        </div>

                    </div>
                </div>
            </div>

            <!-- Banner -->
            <div class="col-xs-12 col-md-3 col-banner">
                @shared.banner()
            </div>
        </div>
    </div>
}